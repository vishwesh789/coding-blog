<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><title>Neural Style Transfer with PyTorch: A Comprehensive Tutorial</title><meta name="description" content="Are you interested in creating your own digital artwork? Do you love the style of your favorite artists and want to replicate their techniques? Neural style transfer may be just the tool you need. In this tutorial, we will explore the basics of neural style transfer and demonstrate how to implement it using PyTorch, a popular deep learning framework.

"/><meta property="og:url" content="https://www.codewithgolu.com/python/neural-style-transfer-with-py-torch-a-comprehensive-tutorial/"/><meta property="og:type" content="website"/><meta property="og:title" content="Neural Style Transfer with PyTorch: A Comprehensive Tutorial"/><meta property="og:description" content="Are you interested in creating your own digital artwork? Do you love the style of your favorite artists and want to replicate their techniques? Neural style transfer may be just the tool you need. In this tutorial, we will explore the basics of neural style transfer and demonstrate how to implement it using PyTorch, a popular deep learning framework.

"/><meta property="og:image" content="https://images.pexels.com/photos/4078342/pexels-photo-4078342.jpeg?auto=compress&amp;cs=tinysrgb&amp;w=1260&amp;h=750&amp;dpr=1"/><meta name="twitter:card" content="summary_large_image"/><meta property="twitter:domain" content="codewithgolu.com"/><meta property="twitter:url" content="https://www.codewithgolu.com/python/neural-style-transfer-with-py-torch-a-comprehensive-tutorial/"/><meta name="twitter:title" content="Neural Style Transfer with PyTorch: A Comprehensive Tutorial"/><meta name="twitter:description" content="Are you interested in creating your own digital artwork? Do you love the style of your favorite artists and want to replicate their techniques? Neural style transfer may be just the tool you need. In this tutorial, we will explore the basics of neural style transfer and demonstrate how to implement it using PyTorch, a popular deep learning framework.

"/><meta name="twitter:image" content="https://images.pexels.com/photos/4078342/pexels-photo-4078342.jpeg?auto=compress&amp;cs=tinysrgb&amp;w=1260&amp;h=750&amp;dpr=1"/><meta name="next-head-count" content="15"/><link rel="icon" href="/favicon.svg"/><link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="true"/><link rel="preload" href="/_next/static/css/198502990ad5deb6.css" as="style"/><link rel="stylesheet" href="/_next/static/css/198502990ad5deb6.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-ee7e63bc15b31913.js" defer=""></script><script src="/_next/static/chunks/framework-114634acb84f8baa.js" defer=""></script><script src="/_next/static/chunks/main-ba528792e922dabc.js" defer=""></script><script src="/_next/static/chunks/pages/_app-f7e120030d214ba2.js" defer=""></script><script src="/_next/static/chunks/247-b06725ee5bb02744.js" defer=""></script><script src="/_next/static/chunks/338-ddaf447963f864b9.js" defer=""></script><script src="/_next/static/chunks/945-9df356926dbc7595.js" defer=""></script><script src="/_next/static/chunks/71-91ef00e69ddb721c.js" defer=""></script><script src="/_next/static/chunks/pages/python/%5Bpython%5D-538e6c071f291026.js" defer=""></script><script src="/_next/static/NVcWuSLW1x5mL-DBY0SbX/_buildManifest.js" defer=""></script><script src="/_next/static/NVcWuSLW1x5mL-DBY0SbX/_ssgManifest.js" defer=""></script></head><body id="top"><div id="__next"><main><div><div><header class="header" data-header="true" id="top"><div class="container"><a class="logo" href="/"><img alt="codewithgolu" src="/images/healthWealthLogo.png" width="80" height="25" decoding="async" data-nimg="1" loading="lazy" style="color:transparent"/></a><nav class="navbar" data-navbar="true"><div class="navbar-top"><a class="logo" href="/"><img alt="codewithgolu" src="/images/healthWealthLogo.png" width="80" height="25" decoding="async" data-nimg="1" loading="lazy" style="color:transparent"/></a><button class="nav-close-btn" aria-label="close menu" data-nav-toggler="true"><ion-icon name="close-outline" aria-hidden="true"></ion-icon></button></div><ul class="navbar-list"><li><a class="navbar-link hover-1" data-nav-toggler="true" href="/category/python/">Python</a></li><li><a class="navbar-link hover-1" data-nav-toggler="true" href="/category/reactjs/">Reactjs</a></li></ul><p class="copyright-text" style="margin-top:20px">Copyright 2022 Â© codewithgolu -Developed by Vishwesh Singh</p></nav><a class="btn btn-primary" href="/python/neural-style-transfer-with-py-torch-a-comprehensive-tutorial/#">Subscribe</a><button class="nav-open-btn" aria-label="open menu" data-nav-toggler="true"><ion-icon name="menu-outline" aria-hidden="true"></ion-icon></button></div></header><a class="back-top-btn" aria-label="back to top" data-back-top-btn="true" href="/python/neural-style-transfer-with-py-torch-a-comprehensive-tutorial/#top"><ion-icon name="arrow-up-outline" aria-hidden="true"></ion-icon></a></div><div class="container" style="margin-top:120px"><div class="card feature-card"><figure class="card-banner img-holder" style="--width:1602;--height:903"><img alt="Neural Style Transfer with PyTorch: A Comprehensive Tutorial" src="https://images.pexels.com/photos/4078342/pexels-photo-4078342.jpeg?auto=compress&amp;cs=tinysrgb&amp;w=1260&amp;h=750&amp;dpr=1" width="1602" height="903" decoding="async" data-nimg="1" class="img-cover" loading="lazy" style="color:transparent"/></figure><div style="flex-direction:row;display:flex;gap:5px"><button aria-label="facebook" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer;outline:none"><svg viewBox="0 0 64 64" width="32" height="32"><circle cx="32" cy="32" r="31" fill="#3b5998"></circle><path d="M34.1,47V33.3h4.6l0.7-5.3h-5.3v-3.4c0-1.5,0.4-2.6,2.6-2.6l2.8,0v-4.8c-0.5-0.1-2.2-0.2-4.1-0.2 c-4.1,0-6.9,2.5-6.9,7V28H24v5.3h4.6V47H34.1z" fill="white"></path></svg></button><button aria-label="pinterest" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer;outline:none"><svg viewBox="0 0 64 64" width="32" height="32"><circle cx="32" cy="32" r="31" fill="#cb2128"></circle><path d="M32,16c-8.8,0-16,7.2-16,16c0,6.6,3.9,12.2,9.6,14.7c0-1.1,0-2.5,0.3-3.7 c0.3-1.3,2.1-8.7,2.1-8.7s-0.5-1-0.5-2.5c0-2.4,1.4-4.1,3.1-4.1c1.5,0,2.2,1.1,2.2,2.4c0,1.5-0.9,3.7-1.4,5.7 c-0.4,1.7,0.9,3.1,2.5,3.1c3,0,5.1-3.9,5.1-8.5c0-3.5-2.4-6.1-6.7-6.1c-4.9,0-7.9,3.6-7.9,7.7c0,1.4,0.4,2.4,1.1,3.1 c0.3,0.3,0.3,0.5,0.2,0.9c-0.1,0.3-0.3,1-0.3,1.3c-0.1,0.4-0.4,0.6-0.8,0.4c-2.2-0.9-3.3-3.4-3.3-6.1c0-4.5,3.8-10,11.4-10 c6.1,0,10.1,4.4,10.1,9.2c0,6.3-3.5,11-8.6,11c-1.7,0-3.4-0.9-3.9-2c0,0-0.9,3.7-1.1,4.4c-0.3,1.2-1,2.5-1.6,3.4 c1.4,0.4,3,0.7,4.5,0.7c8.8,0,16-7.2,16-16C48,23.2,40.8,16,32,16z" fill="white"></path></svg></button><button aria-label="reddit" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer;outline:none"><svg viewBox="0 0 64 64" width="32" height="32"><circle cx="32" cy="32" r="31" fill="#ff4500"></circle><path d="m 52.8165,31.942362 c 0,-2.4803 -2.0264,-4.4965 -4.5169,-4.4965 -1.2155,0 -2.3171,0.4862 -3.128,1.2682 -3.077,-2.0247 -7.2403,-3.3133 -11.8507,-3.4782 l 2.5211,-7.9373 6.8272,1.5997 -0.0102,0.0986 c 0,2.0281 1.6575,3.6771 3.6958,3.6771 2.0366,0 3.6924,-1.649 3.6924,-3.6771 0,-2.0281 -1.6575,-3.6788 -3.6924,-3.6788 -1.564,0 -2.8968,0.9758 -3.4357,2.3443 l -7.3593,-1.7255 c -0.3213,-0.0782 -0.6477,0.1071 -0.748,0.4233 L 32,25.212062 c -4.8246,0.0578 -9.1953,1.3566 -12.41,3.4425 -0.8058,-0.7446 -1.8751,-1.2104 -3.0583,-1.2104 -2.4905,0 -4.5152,2.0179 -4.5152,4.4982 0,1.649 0.9061,3.0787 2.2389,3.8607 -0.0884,0.4794 -0.1462,0.9639 -0.1462,1.4569 0,6.6487 8.1736,12.0581 18.2223,12.0581 10.0487,0 18.224,-5.4094 18.224,-12.0581 0,-0.4658 -0.0493,-0.9248 -0.1275,-1.377 1.4144,-0.7599 2.3885,-2.2304 2.3885,-3.9406 z m -29.2808,3.0872 c 0,-1.4756 1.207,-2.6775 2.6894,-2.6775 1.4824,0 2.6877,1.2019 2.6877,2.6775 0,1.4756 -1.2053,2.6758 -2.6877,2.6758 -1.4824,0 -2.6894,-1.2002 -2.6894,-2.6758 z m 15.4037,7.9373 c -1.3549,1.3481 -3.4816,2.0043 -6.5008,2.0043 l -0.0221,-0.0051 -0.0221,0.0051 c -3.0209,0 -5.1476,-0.6562 -6.5008,-2.0043 -0.2465,-0.2448 -0.2465,-0.6443 0,-0.8891 0.2465,-0.2465 0.6477,-0.2465 0.8942,0 1.105,1.0999 2.9393,1.6337 5.6066,1.6337 l 0.0221,0.0051 0.0221,-0.0051 c 2.6673,0 4.5016,-0.5355 5.6066,-1.6354 0.2465,-0.2465 0.6477,-0.2448 0.8942,0 0.2465,0.2465 0.2465,0.6443 0,0.8908 z m -0.3213,-5.2615 c -1.4824,0 -2.6877,-1.2002 -2.6877,-2.6758 0,-1.4756 1.2053,-2.6775 2.6877,-2.6775 1.4824,0 2.6877,1.2019 2.6877,2.6775 0,1.4756 -1.2053,2.6758 -2.6877,2.6758 z" fill="white"></path></svg></button><button aria-label="whatsapp" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer;outline:none"><svg viewBox="0 0 64 64" width="32" height="32"><circle cx="32" cy="32" r="31" fill="#25D366"></circle><path d="m42.32286,33.93287c-0.5178,-0.2589 -3.04726,-1.49644 -3.52105,-1.66732c-0.4712,-0.17346 -0.81554,-0.2589 -1.15987,0.2589c-0.34175,0.51004 -1.33075,1.66474 -1.63108,2.00648c-0.30032,0.33658 -0.60064,0.36247 -1.11327,0.12945c-0.5178,-0.2589 -2.17994,-0.80259 -4.14759,-2.56312c-1.53269,-1.37217 -2.56312,-3.05503 -2.86603,-3.57283c-0.30033,-0.5178 -0.03366,-0.80259 0.22524,-1.06149c0.23301,-0.23301 0.5178,-0.59547 0.7767,-0.90616c0.25372,-0.31068 0.33657,-0.5178 0.51262,-0.85437c0.17088,-0.36246 0.08544,-0.64725 -0.04402,-0.90615c-0.12945,-0.2589 -1.15987,-2.79613 -1.58964,-3.80584c-0.41424,-1.00971 -0.84142,-0.88027 -1.15987,-0.88027c-0.29773,-0.02588 -0.64208,-0.02588 -0.98382,-0.02588c-0.34693,0 -0.90616,0.12945 -1.37736,0.62136c-0.4712,0.5178 -1.80194,1.76053 -1.80194,4.27186c0,2.51134 1.84596,4.945 2.10227,5.30747c0.2589,0.33657 3.63497,5.51458 8.80262,7.74113c1.23237,0.5178 2.1903,0.82848 2.94111,1.08738c1.23237,0.38836 2.35599,0.33657 3.24402,0.20712c0.99159,-0.15534 3.04985,-1.24272 3.47963,-2.45956c0.44013,-1.21683 0.44013,-2.22654 0.31068,-2.45955c-0.12945,-0.23301 -0.46601,-0.36247 -0.98382,-0.59548m-9.40068,12.84407l-0.02589,0c-3.05503,0 -6.08417,-0.82849 -8.72495,-2.38189l-0.62136,-0.37023l-6.47252,1.68286l1.73463,-6.29129l-0.41424,-0.64725c-1.70875,-2.71846 -2.6149,-5.85116 -2.6149,-9.07706c0,-9.39809 7.68934,-17.06155 17.15993,-17.06155c4.58253,0 8.88029,1.78642 12.11655,5.02268c3.23625,3.21036 5.02267,7.50812 5.02267,12.06476c-0.0078,9.3981 -7.69712,17.06155 -17.14699,17.06155m14.58906,-31.58846c-3.93529,-3.80584 -9.1133,-5.95471 -14.62789,-5.95471c-11.36055,0 -20.60848,9.2065 -20.61625,20.52564c0,3.61684 0.94757,7.14565 2.75211,10.26282l-2.92557,10.63564l10.93337,-2.85309c3.0136,1.63108 6.4052,2.4958 9.85634,2.49839l0.01037,0c11.36574,0 20.61884,-9.2091 20.62403,-20.53082c0,-5.48093 -2.14111,-10.64081 -6.03239,-14.51915" fill="white"></path></svg></button><button aria-label="linkedin" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer;outline:none"><svg viewBox="0 0 64 64" width="32" height="32"><circle cx="32" cy="32" r="31" fill="#007fb1"></circle><path d="M20.4,44h5.4V26.6h-5.4V44z M23.1,18c-1.7,0-3.1,1.4-3.1,3.1c0,1.7,1.4,3.1,3.1,3.1 c1.7,0,3.1-1.4,3.1-3.1C26.2,19.4,24.8,18,23.1,18z M39.5,26.2c-2.6,0-4.4,1.4-5.1,2.8h-0.1v-2.4h-5.2V44h5.4v-8.6 c0-2.3,0.4-4.5,3.2-4.5c2.8,0,2.8,2.6,2.8,4.6V44H46v-9.5C46,29.8,45,26.2,39.5,26.2z" fill="white"></path></svg></button><button aria-label="telegram" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer;outline:none"><svg viewBox="0 0 64 64" width="32" height="32"><circle cx="32" cy="32" r="31" fill="#37aee2"></circle><path d="m45.90873,15.44335c-0.6901,-0.0281 -1.37668,0.14048 -1.96142,0.41265c-0.84989,0.32661 -8.63939,3.33986 -16.5237,6.39174c-3.9685,1.53296 -7.93349,3.06593 -10.98537,4.24067c-3.05012,1.1765 -5.34694,2.05098 -5.4681,2.09312c-0.80775,0.28096 -1.89996,0.63566 -2.82712,1.72788c-0.23354,0.27218 -0.46884,0.62161 -0.58825,1.10275c-0.11941,0.48114 -0.06673,1.09222 0.16682,1.5716c0.46533,0.96052 1.25376,1.35737 2.18443,1.71383c3.09051,0.99037 6.28638,1.93508 8.93263,2.8236c0.97632,3.44171 1.91401,6.89571 2.84116,10.34268c0.30554,0.69185 0.97105,0.94823 1.65764,0.95525l-0.00351,0.03512c0,0 0.53908,0.05268 1.06412,-0.07375c0.52679,-0.12292 1.18879,-0.42846 1.79109,-0.99212c0.662,-0.62161 2.45836,-2.38812 3.47683,-3.38552l7.6736,5.66477l0.06146,0.03512c0,0 0.84989,0.59703 2.09312,0.68132c0.62161,0.04214 1.4399,-0.07726 2.14229,-0.59176c0.70766,-0.51626 1.1765,-1.34683 1.396,-2.29506c0.65673,-2.86224 5.00979,-23.57745 5.75257,-27.00686l-0.02107,0.08077c0.51977,-1.93157 0.32837,-3.70159 -0.87096,-4.74991c-0.60054,-0.52152 -1.2924,-0.7498 -1.98425,-0.77965l0,0.00176zm-0.2072,3.29069c0.04741,0.0439 0.0439,0.0439 0.00351,0.04741c-0.01229,-0.00351 0.14048,0.2072 -0.15804,1.32576l-0.01229,0.04214l-0.00878,0.03863c-0.75858,3.50668 -5.15554,24.40802 -5.74203,26.96472c-0.08077,0.34417 -0.11414,0.31959 -0.09482,0.29852c-0.1756,-0.02634 -0.50045,-0.16506 -0.52679,-0.1756l-13.13468,-9.70175c4.4988,-4.33199 9.09945,-8.25307 13.744,-12.43229c0.8218,-0.41265 0.68483,-1.68573 -0.29852,-1.70681c-1.04305,0.24584 -1.92279,0.99564 -2.8798,1.47502c-5.49971,3.2626 -11.11882,6.13186 -16.55882,9.49279c-2.792,-0.97105 -5.57873,-1.77704 -8.15298,-2.57601c2.2336,-0.89555 4.00889,-1.55579 5.75608,-2.23009c3.05188,-1.1765 7.01687,-2.7042 10.98537,-4.24067c7.94051,-3.06944 15.92667,-6.16346 16.62028,-6.43037l0.05619,-0.02283l0.05268,-0.02283c0.19316,-0.0878 0.30378,-0.09658 0.35471,-0.10009c0,0 -0.01756,-0.05795 -0.00351,-0.04566l-0.00176,0zm-20.91715,22.0638l2.16687,1.60145c-0.93418,0.91311 -1.81743,1.77353 -2.45485,2.38812l0.28798,-3.98957" fill="white"></path></svg></button><button aria-label="twitter" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer;outline:none"><svg viewBox="0 0 64 64" width="32" height="32"><circle cx="32" cy="32" r="31" fill="#00aced"></circle><path d="M48,22.1c-1.2,0.5-2.4,0.9-3.8,1c1.4-0.8,2.4-2.1,2.9-3.6c-1.3,0.8-2.7,1.3-4.2,1.6 C41.7,19.8,40,19,38.2,19c-3.6,0-6.6,2.9-6.6,6.6c0,0.5,0.1,1,0.2,1.5c-5.5-0.3-10.3-2.9-13.5-6.9c-0.6,1-0.9,2.1-0.9,3.3 c0,2.3,1.2,4.3,2.9,5.5c-1.1,0-2.1-0.3-3-0.8c0,0,0,0.1,0,0.1c0,3.2,2.3,5.8,5.3,6.4c-0.6,0.1-1.1,0.2-1.7,0.2c-0.4,0-0.8,0-1.2-0.1 c0.8,2.6,3.3,4.5,6.1,4.6c-2.2,1.8-5.1,2.8-8.2,2.8c-0.5,0-1.1,0-1.6-0.1c2.9,1.9,6.4,2.9,10.1,2.9c12.1,0,18.7-10,18.7-18.7 c0-0.3,0-0.6,0-0.8C46,24.5,47.1,23.4,48,22.1z" fill="white"></path></svg></button></div><div class="card-content"><div class="card-wrapper"><div class="card-tag"><a class="span hover-2" href="/python/neural-style-transfer-with-py-torch-a-comprehensive-tutorial/#">#<!-- -->PyTorch</a></div><div class="wrapper"><ion-icon name="time-outline" aria-hidden="true"></ion-icon><span class="span">5<!-- --> mins read</span></div></div><div class="card-wrapper"><div class="profile-card"><div><p class="card-title">By:<!-- --> <!-- -->vishwesh</p></div></div></div><h1 class="headline headline-3" style="font-size:30px">Neural Style Transfer with PyTorch: A Comprehensive Tutorial</h1><div class="content" style="margin-top:30px;word-spacing:3px;font-size:18px;font-weight:normal"><p>Are you a fan of digital art and wondering how you can create your own unique pieces? Neural style transfer is an exciting new technique that allows you to combine the content of one image with the style of another to create stunning artwork. In this tutorial, we will show you how to implement neural style transfer using PyTorch, a popular deep learning framework, and the VGG19 network, a pre-trained convolutional neural network.</p>
<h3><strong>What is Neural Style Transfer?</strong></h3>
<p>Neural style transfer is a technique for generating new images that combine the content of one image with the style of another. It works by using a pre-trained neural network to extract the features of both the content and style images, and then combining those features to generate a new image that has the same content as the original image but with the style of the other image. The resulting image is a unique piece of art that blends the characteristics of the original images in a visually appealing way.</p>
<h3><strong>Getting Started with PyTorch</strong></h3>
<p>Before we dive into the details of neural style transfer, let&#x27;s first familiarize ourselves with PyTorch. PyTorch is a popular open-source deep learning framework that provides a simple and flexible way to build and train neural networks. It has a user-friendly interface that makes it easy to experiment with different models and architectures.</p>
<p>To get started with PyTorch, you can install it using pip:</p>
<p>Copy code</p>
<pre class="language-plaintext"><code class="language-plaintext"><span class="code-line">pip install torch torchvision
</span></code></pre>
<p>Once you have installed PyTorch, you can import it in your Python code:</p>
<pre class="language-python"><code class="language-python"><span class="code-line"><span class="token keyword">import</span> torch
</span></code></pre>
<h3><strong>Preparing the Images</strong></h3>
<p>To implement neural style transfer, we need two images: a content image and a style image. The content image is the image that we want to preserve the content of, and the style image is the image that we want to extract the style from. In this tutorial, we will use a picture of a city as the content image and a famous painting by Van Gogh as the style image.</p>
<pre class="language-python"><code class="language-python"><span class="code-line"><span class="token keyword">from</span> PIL <span class="token keyword">import</span> Image
</span><span class="code-line"><span class="token keyword">from</span> torchvision <span class="token keyword">import</span> transforms
</span><span class="code-line">
</span><span class="code-line"><span class="token comment"># Load the images</span>
</span><span class="code-line">content_image <span class="token operator">=</span> Image<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">&quot;city.jpg&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line">style_image <span class="token operator">=</span> Image<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">&quot;vangogh.jpg&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment"># Define the transforms to apply to the images</span>
</span><span class="code-line">transform <span class="token operator">=</span> transforms<span class="token punctuation">.</span>Compose<span class="token punctuation">(</span><span class="token punctuation">[</span>
</span><span class="code-line">    transforms<span class="token punctuation">.</span>Resize<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
</span><span class="code-line">    transforms<span class="token punctuation">.</span>ToTensor<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
</span><span class="code-line">    transforms<span class="token punctuation">.</span>Normalize<span class="token punctuation">(</span>mean<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0.485</span><span class="token punctuation">,</span> <span class="token number">0.456</span><span class="token punctuation">,</span> <span class="token number">0.406</span><span class="token punctuation">]</span><span class="token punctuation">,</span> std<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0.229</span><span class="token punctuation">,</span> <span class="token number">0.224</span><span class="token punctuation">,</span> <span class="token number">0.225</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token punctuation">]</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment"># Apply the transforms to the images</span>
</span><span class="code-line">content_tensor <span class="token operator">=</span> transform<span class="token punctuation">(</span>content_image<span class="token punctuation">)</span><span class="token punctuation">.</span>unsqueeze<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
</span><span class="code-line">style_tensor <span class="token operator">=</span> transform<span class="token punctuation">(</span>style_image<span class="token punctuation">)</span><span class="token punctuation">.</span>unsqueeze<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
</span></code></pre>
<p>In the code above, we load the content and style images using the PIL library, which is a popular library for image manipulation in Python. We then define a set of transforms to apply to the images, including resizing the images to 512x512 pixels, converting them to tensors, and normalizing the pixel values to have zero mean and unit variance. Finally, we apply the transforms to the images and convert them to tensors.</p>
<h3><strong>Defining the Content and Style Loss</strong></h3>
<p>To implement neural style transfer, we need to define two loss functions: the content loss and the style loss. The content loss measures the difference between the features of the generated image and the content image, while the style loss measures the difference between the features of the generated image and the style image.</p>
<pre class="language-python"><code class="language-python"><span class="code-line"><span class="token keyword">import</span> torch<span class="token punctuation">.</span>nn <span class="token keyword">as</span> nn
</span><span class="code-line">
</span><span class="code-line"><span class="token comment"># Define the content loss</span>
</span><span class="code-line"><span class="token keyword">class</span> <span class="token class-name">ContentLoss</span><span class="token punctuation">(</span>nn<span class="token punctuation">.</span>Module<span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> target_feature<span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token builtin">super</span><span class="token punctuation">(</span>ContentLoss<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">        self<span class="token punctuation">.</span>target <span class="token operator">=</span> target_feature<span class="token punctuation">.</span>detach<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">        
</span><span class="code-line">    <span class="token keyword">def</span> <span class="token function">forward</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token builtin">input</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">        self<span class="token punctuation">.</span>loss <span class="token operator">=</span> nn<span class="token punctuation">.</span>functional<span class="token punctuation">.</span>mse_loss<span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>target<span class="token punctuation">)</span>
</span><span class="code-line">        <span class="token keyword">return</span> <span class="token builtin">input</span>
</span></code></pre>
<p>In the code above, we define the content loss as a custom PyTorch module. The <strong>__init__</strong> method takes as input the target feature, which is the feature of the content image that we want to preserve. We store the target feature as a class variable so that we can access it later. The <strong>forward</strong> method takes as input the feature of the generated image and computes the mean squared error (MSE) loss between the generated feature and the target feature. We store the loss as a class variable so that we can access it later.</p>
<pre class="language-python"><code class="language-python"><span class="code-line"><span class="token comment"># Define the style loss</span>
</span><span class="code-line"><span class="token keyword">class</span> <span class="token class-name">StyleLoss</span><span class="token punctuation">(</span>nn<span class="token punctuation">.</span>Module<span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> target_feature<span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token builtin">super</span><span class="token punctuation">(</span>StyleLoss<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">        self<span class="token punctuation">.</span>target <span class="token operator">=</span> gram_matrix<span class="token punctuation">(</span>target_feature<span class="token punctuation">)</span><span class="token punctuation">.</span>detach<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">        
</span><span class="code-line">    <span class="token keyword">def</span> <span class="token function">forward</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token builtin">input</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">        G <span class="token operator">=</span> gram_matrix<span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">)</span>
</span><span class="code-line">        self<span class="token punctuation">.</span>loss <span class="token operator">=</span> nn<span class="token punctuation">.</span>functional<span class="token punctuation">.</span>mse_loss<span class="token punctuation">(</span>G<span class="token punctuation">,</span> self<span class="token punctuation">.</span>target<span class="token punctuation">)</span>
</span><span class="code-line">        <span class="token keyword">return</span> <span class="token builtin">input</span>
</span></code></pre>
<p>In the code above, we define the style loss as a custom PyTorch module. The <strong>__init__</strong> method takes as input the target feature, which is the feature of the style image that we want to match. We compute the Gram matrix of the target feature and store it as a class variable. The <strong>forward</strong> method takes as input the feature of the generated image and computes the Gram matrix of the feature. We then compute the MSE loss between the Gram matrix of the generated feature and the target Gram matrix. We store the loss as a class variable so that we can access it later.</p>
<h3><strong>Extracting Features with VGG19</strong></h3>
<p>To compute the content and style loss, we need to extract the features of the content and style images using a pre-trained neural network. In this tutorial, we will use the VGG19 network, which is a deep convolutional neural network that is commonly used for image classification and feature extraction.</p>
<pre class="language-python"><code class="language-python"><span class="code-line"><span class="token keyword">import</span> torchvision<span class="token punctuation">.</span>models <span class="token keyword">as</span> models
</span><span class="code-line">
</span><span class="code-line"><span class="token comment"># Load the pre-trained VGG19 model</span>
</span><span class="code-line">vgg <span class="token operator">=</span> models<span class="token punctuation">.</span>vgg19<span class="token punctuation">(</span>pretrained<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">.</span>features
</span><span class="code-line">
</span><span class="code-line"><span class="token comment"># Freeze all the model parameters</span>
</span><span class="code-line"><span class="token keyword">for</span> param <span class="token keyword">in</span> vgg<span class="token punctuation">.</span>parameters<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">    param<span class="token punctuation">.</span>requires_grad_<span class="token punctuation">(</span><span class="token boolean">False</span><span class="token punctuation">)</span>
</span></code></pre>
<p>In the code above, we load the pre-trained VGG19 model using the torchvision.models module. We then freeze all the parameters of the model so that we do not update them during training. We only want to update the parameters of the generated image.</p>
<pre class="language-python"><code class="language-python"><span class="code-line"><span class="token keyword">def</span> <span class="token function">get_features</span><span class="token punctuation">(</span>image<span class="token punctuation">,</span> model<span class="token punctuation">,</span> layers<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token keyword">if</span> layers <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
</span><span class="code-line">        layers <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;0&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;conv1_1&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">                  <span class="token string">&quot;5&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;conv2_1&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">                  <span class="token string">&quot;10&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;conv3_1&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">                  <span class="token string">&quot;19&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;conv4_1&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">                  <span class="token string">&quot;28&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;conv5_1&quot;</span><span class="token punctuation">}</span>
</span><span class="code-line">    
</span><span class="code-line">    features <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</span><span class="code-line">    x <span class="token operator">=</span> image
</span><span class="code-line">    
</span><span class="code-line">    <span class="token keyword">for</span> name<span class="token punctuation">,</span> layer <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>model<span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">        x <span class="token operator">=</span> layer<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
</span><span class="code-line">        <span class="token keyword">if</span> <span class="token builtin">str</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token keyword">in</span> layers<span class="token punctuation">:</span>
</span><span class="code-line">            features<span class="token punctuation">[</span>layers<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> x
</span><span class="code-line">            
</span><span class="code-line">    <span class="token keyword">return</span> features
</span></code></pre>
<p>In the code above, we define a function to extract the features of an image using the pre-trained VGG19 model. The <strong>get_features</strong> function takes as input an image, a model, and a dictionary of layers that we want to extract features from. By default, we extract features from the first five convolutional layers of the model.</p>
<p>The function initializes an empty dictionary to store the features and then iterates over each layer of the model. For each layer, we apply the layer to the input image and store the output feature if the layer is one of the layers we want to extract features from. Finally, the function returns the dictionary of features.</p>
<h3><strong>Putting it all Together: Generating the Stylized Image</strong></h3>
<p>Now that we have defined the content and style loss and have a way to extract features from an image, we can put everything together to generate the stylized image.</p>
<pre class="language-python"><code class="language-python"><span class="code-line"><span class="token keyword">def</span> <span class="token function">get_stylized_image</span><span class="token punctuation">(</span>content_image<span class="token punctuation">,</span> style_image<span class="token punctuation">,</span> num_steps<span class="token operator">=</span><span class="token number">2000</span><span class="token punctuation">,</span> style_weight<span class="token operator">=</span><span class="token number">100000</span><span class="token punctuation">,</span> content_weight<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token comment"># Load the VGG19 model and freeze its parameters</span>
</span><span class="code-line">    vgg <span class="token operator">=</span> models<span class="token punctuation">.</span>vgg19<span class="token punctuation">(</span>pretrained<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">.</span>features
</span><span class="code-line">    <span class="token keyword">for</span> param <span class="token keyword">in</span> vgg<span class="token punctuation">.</span>parameters<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">        param<span class="token punctuation">.</span>requires_grad_<span class="token punctuation">(</span><span class="token boolean">False</span><span class="token punctuation">)</span>
</span><span class="code-line">        
</span><span class="code-line">    <span class="token comment"># Define the content and style layers</span>
</span><span class="code-line">    content_layers <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;4&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;conv1_2&quot;</span><span class="token punctuation">}</span>
</span><span class="code-line">    style_layers <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;0&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;conv1_1&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">                    <span class="token string">&quot;5&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;conv2_1&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">                    <span class="token string">&quot;10&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;conv3_1&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">                    <span class="token string">&quot;19&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;conv4_1&quot;</span><span class="token punctuation">,</span>
</span><span class="code-line">                    <span class="token string">&quot;28&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;conv5_1&quot;</span><span class="token punctuation">}</span>
</span><span class="code-line">    
</span><span class="code-line">    <span class="token comment"># Extract the features of the content and style images</span>
</span><span class="code-line">    content_features <span class="token operator">=</span> get_features<span class="token punctuation">(</span>content_image<span class="token punctuation">,</span> vgg<span class="token punctuation">,</span> content_layers<span class="token punctuation">)</span>
</span><span class="code-line">    style_features <span class="token operator">=</span> get_features<span class="token punctuation">(</span>style_image<span class="token punctuation">,</span> vgg<span class="token punctuation">,</span> style_layers<span class="token punctuation">)</span>
</span><span class="code-line">    
</span><span class="code-line">    <span class="token comment"># Initialize the generated image with random noise</span>
</span><span class="code-line">    input_image <span class="token operator">=</span> torch<span class="token punctuation">.</span>randn_like<span class="token punctuation">(</span>content_image<span class="token punctuation">)</span><span class="token punctuation">.</span>requires_grad_<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span>
</span><span class="code-line">    
</span><span class="code-line">    <span class="token comment"># Define the optimizer and the loss</span>
</span><span class="code-line">    optimizer <span class="token operator">=</span> torch<span class="token punctuation">.</span>optim<span class="token punctuation">.</span>Adam<span class="token punctuation">(</span><span class="token punctuation">[</span>input_image<span class="token punctuation">]</span><span class="token punctuation">,</span> lr<span class="token operator">=</span><span class="token number">0.01</span><span class="token punctuation">)</span>
</span><span class="code-line">    content_loss <span class="token operator">=</span> ContentLoss<span class="token punctuation">(</span>content_features<span class="token punctuation">[</span><span class="token string">&quot;conv1_2&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</span><span class="code-line">    style_loss <span class="token operator">=</span> StyleLoss<span class="token punctuation">(</span>style_features<span class="token punctuation">[</span><span class="token string">&quot;conv1_1&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</span><span class="code-line">    
</span><span class="code-line">    <span class="token comment"># Train the model</span>
</span><span class="code-line">    <span class="token keyword">for</span> step <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>num_steps<span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token comment"># Compute the features of the generated image</span>
</span><span class="code-line">        input_features <span class="token operator">=</span> get_features<span class="token punctuation">(</span>input_image<span class="token punctuation">,</span> vgg<span class="token punctuation">)</span>
</span><span class="code-line">        
</span><span class="code-line">        <span class="token comment"># Compute the content and style loss</span>
</span><span class="code-line">        content_loss<span class="token punctuation">(</span>input_features<span class="token punctuation">[</span><span class="token string">&quot;conv1_2&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</span><span class="code-line">        style_loss<span class="token punctuation">(</span>input_features<span class="token punctuation">[</span><span class="token string">&quot;conv1_1&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> input_features<span class="token punctuation">[</span><span class="token string">&quot;conv2_1&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> input_features<span class="token punctuation">[</span><span class="token string">&quot;conv3_1&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> input_features<span class="token punctuation">[</span><span class="token string">&quot;conv4_1&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> input_features<span class="token punctuation">[</span><span class="token string">&quot;conv5_1&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</span><span class="code-line">        
</span><span class="code-line">        <span class="token comment"># Compute the total loss</span>
</span><span class="code-line">        loss <span class="token operator">=</span> content_weight <span class="token operator">*</span> content_loss<span class="token punctuation">.</span>loss <span class="token operator">+</span> style_weight <span class="token operator">*</span> style_loss<span class="token punctuation">.</span>loss
</span><span class="code-line">        
</span><span class="code-line">        <span class="token comment"># Update the generated image</span>
</span><span class="code-line">        optimizer<span class="token punctuation">.</span>zero_grad<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">        loss<span class="token punctuation">.</span>backward<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">        optimizer<span class="token punctuation">.</span>step<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">        
</span><span class="code-line">        <span class="token comment"># Clamp the pixel values to the range [0, 1]</span>
</span><span class="code-line">        input_image<span class="token punctuation">.</span>data<span class="token punctuation">.</span>clamp_<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
</span><span class="code-line">        
</span><span class="code-line">        <span class="token keyword">if</span> step <span class="token operator">%</span> <span class="token number">100</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
</span><span class="code-line">            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Step [{}/{}]: Content Loss: {:.4f}, Style Loss: {:.4f}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>step<span class="token punctuation">,</span> num_steps<span class="token punctuation">,</span> content_loss<span class="token punctuation">.</span>loss<span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> style_loss<span class="token punctuation">.</span>loss<span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">    
</span><span class="code-line">    <span class="token keyword">return</span> input_image
</span></code></pre>
<p>In the code above, we define a function to generate the stylized image given a content image and a style image. The function takes as input the content image, the style image, the number of optimization steps to perform, the weight of the style loss, and the weight of the content loss.</p>
<p>The function first loads the VGG19 model and freezes its parameters. It then defines the layers to use for the content and style losses and extracts the features of the content and style images using the <strong>get_features</strong> function.</p>
<p>Next, the function initializes the generated image with random noise and defines the optimizer and the content and style losses. We use the Adam optimizer with a learning rate of 0.01 to optimize the generated image.</p>
<p>The content loss is computed using the features of the content image at layer <strong>conv1_2</strong>, which corresponds to the second convolutional layer of the VGG19 model.</p>
<p>The style loss is computed using the features of the style image at multiple layers of the VGG19 model. Specifically, we use the first convolutional layer (<strong>conv1_1</strong>), the first convolutional layer of the second block (<strong>conv2_1</strong>), the first convolutional layer of the third block (<strong>conv3_1</strong>), the first convolutional layer of the fourth block (<strong>conv4_1</strong>), and the first convolutional layer of the fifth block (<strong>conv5_1</strong>). These layers have been found to capture the style information of the image well.</p>
<p>Finally, the function performs the optimization to generate the stylized image. For each optimization step, we compute the features of the generated image using the <strong>get_features</strong> function and compute the content and style loss using the <strong>ContentLoss</strong> and <strong>StyleLoss</strong> classes. We then compute the total loss as a weighted sum of the content loss and the style loss and update the generated image using the optimizer.</p>
<p>At every 100th step, we print the content and style loss for monitoring the progress. After the specified number of steps, we return the generated image.</p>
<h3><strong>Conclusion</strong></h3>
<p>In this tutorial, we have learned how to implement neural style transfer using PyTorch. We have discussed the theory behind neural style transfer, including the content loss and style loss, and shown how to implement these losses using PyTorch.</p>
<p>We have also shown how to extract features from an image using a pre-trained VGG19 model and how to use these features to compute the content and style losses. Finally, we have shown how to put everything together to generate a stylized image.</p>
<p>Neural style transfer is a powerful technique that can be used to create beautiful and artistic images. By changing the style image, we can create different stylized versions of the same content image. With the knowledge gained in this tutorial, you can experiment with different style images and explore the creative possibilities of neural style transfer.</p></div></div></div></div><section class="section recent-post" id="recent" aria-labelledby="recent-label"><div class="container"><div class="post-main"><h2 class="headline headline-2 section-title"><span class="span">Recent posts</span></h2><p class="section-text">Don&#x27;t miss the latest trends</p><ul class="grid-list"></ul></div><div class="post-aside grid-list"><div class="card aside-card"><h3 class="headline headline-2 aside-title"><span class="span">Popular Posts</span></h3></div></div></div></section><section class="tags" aria-labelledby="tag-label" style="margin-top:50px"><div class="container"><h2 class="headline headline-2 section-title" id="tag-label"><span class="span">Popular Categories</span></h2><ul class="grid-list" style="margin-top:50px"><li><a class="card tag-btn" href="https://www.codewithgolu.com/category/career/"><p class="btn-text">Career</p></a></li><li><a class="card tag-btn" href="https://www.codewithgolu.com/category/finance/"><p class="btn-text">Finance</p></a></li><li><a class="card tag-btn" href="https://www.codewithgolu.com/category/lifestyle/"><p class="btn-text">Lifestyle</p></a></li><li><a class="card tag-btn" href="https://www.codewithgolu.com/category/technology/"><p class="btn-text">Technologies</p></a></li><li><a class="card tag-btn" href="https://www.codewithgolu.com/category/health/"><p class="btn-text">Health</p></a></li></ul></div></section><footer><div class="container"><div class="card footer"><div class="section footer-top"><div class="footer-brand"><a class="logo" href="/python/neural-style-transfer-with-py-torch-a-comprehensive-tutorial/#"><img alt="codewithgolu" src="/images/healthWealthLogo.png" width="80" height="25" decoding="async" data-nimg="1" loading="lazy" style="color:transparent"/></a><p class="footer-text">Copyright 2023 Â© codewithgolu -Developed by Vishwesh Singh.Our website&#x27;s services, content, and products are provided solely for educational purposes.</p><p class="footer-list-title">Address</p><address class="footer-text address">a-58, sector 21 <br/>Noida, 201304</address></div><div class="footer-list"><p class="footer-list-title">Newsletter</p><p class="footer-text">Sign up to be first to receive the latest stories inspiring us, case studies, and industry news.</p><div class="input-wrapper"><input type="text" name="name" placeholder="Your name" required="" class="input-field" autoComplete="off"/><ion-icon name="person-outline" aria-hidden="true"></ion-icon></div><div class="input-wrapper"><input type="email" name="email_address" placeholder="Emaill address" required="" class="input-field" autoComplete="off"/><ion-icon name="mail-outline" aria-hidden="true"></ion-icon></div><a class="btn btn-primary" href="/python/neural-style-transfer-with-py-torch-a-comprehensive-tutorial/#"><span class="span">Subscribe</span><ion-icon name="arrow-forward" aria-hidden="true"></ion-icon></a></div></div><div class="footer-bottom"><p class="copyright">Â© Developed by<!-- --> <a class="copyright-link" href="/python/neural-style-transfer-with-py-torch-a-comprehensive-tutorial/#">vishwesh</a></p></div></div></div></footer></div></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"content":{"compiledSource":"/*@jsxRuntime automatic @jsxImportSource react*/\nconst {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];\nconst {useMDXComponents: _provideComponents} = arguments[0];\nfunction _createMdxContent(props) {\n  const _components = Object.assign({\n    p: \"p\",\n    h3: \"h3\",\n    strong: \"strong\",\n    pre: \"pre\",\n    code: \"code\",\n    span: \"span\"\n  }, _provideComponents(), props.components);\n  return _jsxs(_Fragment, {\n    children: [_jsx(_components.p, {\n      children: \"Are you a fan of digital art and wondering how you can create your own unique pieces? Neural style transfer is an exciting new technique that allows you to combine the content of one image with the style of another to create stunning artwork. In this tutorial, we will show you how to implement neural style transfer using PyTorch, a popular deep learning framework, and the VGG19 network, a pre-trained convolutional neural network.\"\n    }), \"\\n\", _jsx(_components.h3, {\n      children: _jsx(_components.strong, {\n        children: \"What is Neural Style Transfer?\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Neural style transfer is a technique for generating new images that combine the content of one image with the style of another. It works by using a pre-trained neural network to extract the features of both the content and style images, and then combining those features to generate a new image that has the same content as the original image but with the style of the other image. The resulting image is a unique piece of art that blends the characteristics of the original images in a visually appealing way.\"\n    }), \"\\n\", _jsx(_components.h3, {\n      children: _jsx(_components.strong, {\n        children: \"Getting Started with PyTorch\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Before we dive into the details of neural style transfer, let's first familiarize ourselves with PyTorch. PyTorch is a popular open-source deep learning framework that provides a simple and flexible way to build and train neural networks. It has a user-friendly interface that makes it easy to experiment with different models and architectures.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"To get started with PyTorch, you can install it using pip:\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Copy code\"\n    }), \"\\n\", _jsx(_components.pre, {\n      className: \"language-plaintext\",\n      children: _jsx(_components.code, {\n        className: \"language-plaintext\",\n        children: _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"pip install torch torchvision\\n\"\n        })\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Once you have installed PyTorch, you can import it in your Python code:\"\n    }), \"\\n\", _jsx(_components.pre, {\n      className: \"language-python\",\n      children: _jsx(_components.code, {\n        className: \"language-python\",\n        children: _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"import\"\n          }), \" torch\\n\"]\n        })\n      })\n    }), \"\\n\", _jsx(_components.h3, {\n      children: _jsx(_components.strong, {\n        children: \"Preparing the Images\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"To implement neural style transfer, we need two images: a content image and a style image. The content image is the image that we want to preserve the content of, and the style image is the image that we want to extract the style from. In this tutorial, we will use a picture of a city as the content image and a famous painting by Van Gogh as the style image.\"\n    }), \"\\n\", _jsx(_components.pre, {\n      className: \"language-python\",\n      children: _jsxs(_components.code, {\n        className: \"language-python\",\n        children: [_jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"from\"\n          }), \" PIL \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"import\"\n          }), \" Image\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"from\"\n          }), \" torchvision \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"import\"\n          }), \" transforms\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# Load the images\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"content_image \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" Image\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"open\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"city.jpg\\\"\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"style_image \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" Image\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"open\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"vangogh.jpg\\\"\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# Define the transforms to apply to the images\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"transform \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" transforms\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"Compose\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    transforms\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"Resize\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"512\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    transforms\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"ToTensor\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    transforms\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"Normalize\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"mean\", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.485\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.456\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.406\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" std\", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.229\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.224\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.225\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# Apply the transforms to the images\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"content_tensor \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" transform\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"content_image\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"unsqueeze\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"style_tensor \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" transform\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"style_image\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"unsqueeze\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        })]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"In the code above, we load the content and style images using the PIL library, which is a popular library for image manipulation in Python. We then define a set of transforms to apply to the images, including resizing the images to 512x512 pixels, converting them to tensors, and normalizing the pixel values to have zero mean and unit variance. Finally, we apply the transforms to the images and convert them to tensors.\"\n    }), \"\\n\", _jsx(_components.h3, {\n      children: _jsx(_components.strong, {\n        children: \"Defining the Content and Style Loss\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"To implement neural style transfer, we need to define two loss functions: the content loss and the style loss. The content loss measures the difference between the features of the generated image and the content image, while the style loss measures the difference between the features of the generated image and the style image.\"\n    }), \"\\n\", _jsx(_components.pre, {\n      className: \"language-python\",\n      children: _jsxs(_components.code, {\n        className: \"language-python\",\n        children: [_jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"import\"\n          }), \" torch\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"nn \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"as\"\n          }), \" nn\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# Define the content loss\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"class\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token class-name\",\n            children: \"ContentLoss\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"nn\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"Module\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"def\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token function\",\n            children: \"__init__\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"self\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" target_feature\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        \", _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"super\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"ContentLoss\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" self\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"__init__\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        self\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"target \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" target_feature\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"detach\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"        \\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"def\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token function\",\n            children: \"forward\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"self\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"input\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        self\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"loss \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" nn\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"functional\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"mse_loss\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"input\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" self\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"target\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"return\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"input\"\n          }), \"\\n\"]\n        })]\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"In the code above, we define the content loss as a custom PyTorch module. The \", _jsx(_components.strong, {\n        children: \"__init__\"\n      }), \" method takes as input the target feature, which is the feature of the content image that we want to preserve. We store the target feature as a class variable so that we can access it later. The \", _jsx(_components.strong, {\n        children: \"forward\"\n      }), \" method takes as input the feature of the generated image and computes the mean squared error (MSE) loss between the generated feature and the target feature. We store the loss as a class variable so that we can access it later.\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      className: \"language-python\",\n      children: _jsxs(_components.code, {\n        className: \"language-python\",\n        children: [_jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# Define the style loss\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"class\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token class-name\",\n            children: \"StyleLoss\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"nn\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"Module\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"def\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token function\",\n            children: \"__init__\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"self\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" target_feature\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        \", _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"super\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"StyleLoss\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" self\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"__init__\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        self\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"target \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" gram_matrix\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"target_feature\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"detach\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"        \\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"def\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token function\",\n            children: \"forward\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"self\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"input\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        G \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" gram_matrix\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"input\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        self\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"loss \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" nn\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"functional\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"mse_loss\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"G\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" self\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"target\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"return\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"input\"\n          }), \"\\n\"]\n        })]\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"In the code above, we define the style loss as a custom PyTorch module. The \", _jsx(_components.strong, {\n        children: \"__init__\"\n      }), \" method takes as input the target feature, which is the feature of the style image that we want to match. We compute the Gram matrix of the target feature and store it as a class variable. The \", _jsx(_components.strong, {\n        children: \"forward\"\n      }), \" method takes as input the feature of the generated image and computes the Gram matrix of the feature. We then compute the MSE loss between the Gram matrix of the generated feature and the target Gram matrix. We store the loss as a class variable so that we can access it later.\"]\n    }), \"\\n\", _jsx(_components.h3, {\n      children: _jsx(_components.strong, {\n        children: \"Extracting Features with VGG19\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"To compute the content and style loss, we need to extract the features of the content and style images using a pre-trained neural network. In this tutorial, we will use the VGG19 network, which is a deep convolutional neural network that is commonly used for image classification and feature extraction.\"\n    }), \"\\n\", _jsx(_components.pre, {\n      className: \"language-python\",\n      children: _jsxs(_components.code, {\n        className: \"language-python\",\n        children: [_jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"import\"\n          }), \" torchvision\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"models \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"as\"\n          }), \" models\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# Load the pre-trained VGG19 model\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"vgg \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" models\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"vgg19\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"pretrained\", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), _jsx(_components.span, {\n            className: \"token boolean\",\n            children: \"True\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"features\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# Freeze all the model parameters\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"for\"\n          }), \" param \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"in\"\n          }), \" vgg\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"parameters\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    param\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"requires_grad_\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token boolean\",\n            children: \"False\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        })]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"In the code above, we load the pre-trained VGG19 model using the torchvision.models module. We then freeze all the parameters of the model so that we do not update them during training. We only want to update the parameters of the generated image.\"\n    }), \"\\n\", _jsx(_components.pre, {\n      className: \"language-python\",\n      children: _jsxs(_components.code, {\n        className: \"language-python\",\n        children: [_jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"def\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token function\",\n            children: \"get_features\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"image\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" model\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" layers\", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), _jsx(_components.span, {\n            className: \"token boolean\",\n            children: \"None\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"if\"\n          }), \" layers \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"is\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token boolean\",\n            children: \"None\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        layers \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"{\"\n          }), _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"0\\\"\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"conv1_1\\\"\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"                  \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"5\\\"\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"conv2_1\\\"\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"                  \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"10\\\"\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"conv3_1\\\"\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"                  \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"19\\\"\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"conv4_1\\\"\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"                  \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"28\\\"\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"conv5_1\\\"\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"}\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"    \\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    features \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"{\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"}\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    x \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" image\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"    \\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"for\"\n          }), \" name\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" layer \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"in\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"enumerate\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"model\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        x \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" layer\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"if\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"str\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"name\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"in\"\n          }), \" layers\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"            features\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"layers\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"str\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"name\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" x\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"            \\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"return\"\n          }), \" features\\n\"]\n        })]\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"In the code above, we define a function to extract the features of an image using the pre-trained VGG19 model. The \", _jsx(_components.strong, {\n        children: \"get_features\"\n      }), \" function takes as input an image, a model, and a dictionary of layers that we want to extract features from. By default, we extract features from the first five convolutional layers of the model.\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"The function initializes an empty dictionary to store the features and then iterates over each layer of the model. For each layer, we apply the layer to the input image and store the output feature if the layer is one of the layers we want to extract features from. Finally, the function returns the dictionary of features.\"\n    }), \"\\n\", _jsx(_components.h3, {\n      children: _jsx(_components.strong, {\n        children: \"Putting it all Together: Generating the Stylized Image\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Now that we have defined the content and style loss and have a way to extract features from an image, we can put everything together to generate the stylized image.\"\n    }), \"\\n\", _jsx(_components.pre, {\n      className: \"language-python\",\n      children: _jsxs(_components.code, {\n        className: \"language-python\",\n        children: [_jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"def\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token function\",\n            children: \"get_stylized_image\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"content_image\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" style_image\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" num_steps\", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"2000\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" style_weight\", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"100000\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" content_weight\", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    \", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# Load the VGG19 model and freeze its parameters\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    vgg \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" models\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"vgg19\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"pretrained\", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), _jsx(_components.span, {\n            className: \"token boolean\",\n            children: \"True\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"features\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"for\"\n          }), \" param \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"in\"\n          }), \" vgg\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"parameters\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        param\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"requires_grad_\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token boolean\",\n            children: \"False\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"        \\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    \", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# Define the content and style layers\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    content_layers \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"{\"\n          }), _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"4\\\"\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"conv1_2\\\"\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"}\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    style_layers \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"{\"\n          }), _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"0\\\"\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"conv1_1\\\"\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"                    \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"5\\\"\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"conv2_1\\\"\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"                    \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"10\\\"\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"conv3_1\\\"\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"                    \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"19\\\"\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"conv4_1\\\"\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"                    \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"28\\\"\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"conv5_1\\\"\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"}\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"    \\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    \", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# Extract the features of the content and style images\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    content_features \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" get_features\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"content_image\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" vgg\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" content_layers\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    style_features \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" get_features\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"style_image\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" vgg\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" style_layers\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"    \\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    \", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# Initialize the generated image with random noise\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    input_image \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" torch\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"randn_like\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"content_image\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"requires_grad_\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token boolean\",\n            children: \"True\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"    \\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    \", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# Define the optimizer and the loss\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    optimizer \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" torch\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"optim\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"Adam\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"input_image\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" lr\", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.01\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    content_loss \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" ContentLoss\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"content_features\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"conv1_2\\\"\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    style_loss \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" StyleLoss\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"style_features\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"conv1_1\\\"\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"    \\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    \", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# Train the model\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"for\"\n          }), \" step \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"in\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"range\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"num_steps\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        \", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# Compute the features of the generated image\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        input_features \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" get_features\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"input_image\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" vgg\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"        \\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        \", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# Compute the content and style loss\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        content_loss\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"input_features\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"conv1_2\\\"\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        style_loss\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"input_features\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"conv1_1\\\"\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" input_features\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"conv2_1\\\"\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" input_features\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"conv3_1\\\"\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" input_features\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"conv4_1\\\"\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" input_features\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"conv5_1\\\"\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"        \\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        \", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# Compute the total loss\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        loss \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" content_weight \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"*\"\n          }), \" content_loss\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"loss \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"+\"\n          }), \" style_weight \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"*\"\n          }), \" style_loss\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"loss\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"        \\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        \", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# Update the generated image\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        optimizer\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"zero_grad\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        loss\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"backward\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        optimizer\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"step\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"        \\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        \", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# Clamp the pixel values to the range [0, 1]\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        input_image\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"data\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"clamp_\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"        \\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"if\"\n          }), \" step \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"%\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"100\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"==\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"            \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"print\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"Step [{}/{}]: Content Loss: {:.4f}, Style Loss: {:.4f}\\\"\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"format\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"step\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" num_steps\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" content_loss\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"loss\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"item\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" style_loss\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"loss\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"item\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"    \\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"return\"\n          }), \" input_image\\n\"]\n        })]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"In the code above, we define a function to generate the stylized image given a content image and a style image. The function takes as input the content image, the style image, the number of optimization steps to perform, the weight of the style loss, and the weight of the content loss.\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"The function first loads the VGG19 model and freezes its parameters. It then defines the layers to use for the content and style losses and extracts the features of the content and style images using the \", _jsx(_components.strong, {\n        children: \"get_features\"\n      }), \" function.\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Next, the function initializes the generated image with random noise and defines the optimizer and the content and style losses. We use the Adam optimizer with a learning rate of 0.01 to optimize the generated image.\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"The content loss is computed using the features of the content image at layer \", _jsx(_components.strong, {\n        children: \"conv1_2\"\n      }), \", which corresponds to the second convolutional layer of the VGG19 model.\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"The style loss is computed using the features of the style image at multiple layers of the VGG19 model. Specifically, we use the first convolutional layer (\", _jsx(_components.strong, {\n        children: \"conv1_1\"\n      }), \"), the first convolutional layer of the second block (\", _jsx(_components.strong, {\n        children: \"conv2_1\"\n      }), \"), the first convolutional layer of the third block (\", _jsx(_components.strong, {\n        children: \"conv3_1\"\n      }), \"), the first convolutional layer of the fourth block (\", _jsx(_components.strong, {\n        children: \"conv4_1\"\n      }), \"), and the first convolutional layer of the fifth block (\", _jsx(_components.strong, {\n        children: \"conv5_1\"\n      }), \"). These layers have been found to capture the style information of the image well.\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Finally, the function performs the optimization to generate the stylized image. For each optimization step, we compute the features of the generated image using the \", _jsx(_components.strong, {\n        children: \"get_features\"\n      }), \" function and compute the content and style loss using the \", _jsx(_components.strong, {\n        children: \"ContentLoss\"\n      }), \" and \", _jsx(_components.strong, {\n        children: \"StyleLoss\"\n      }), \" classes. We then compute the total loss as a weighted sum of the content loss and the style loss and update the generated image using the optimizer.\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"At every 100th step, we print the content and style loss for monitoring the progress. After the specified number of steps, we return the generated image.\"\n    }), \"\\n\", _jsx(_components.h3, {\n      children: _jsx(_components.strong, {\n        children: \"Conclusion\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"In this tutorial, we have learned how to implement neural style transfer using PyTorch. We have discussed the theory behind neural style transfer, including the content loss and style loss, and shown how to implement these losses using PyTorch.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"We have also shown how to extract features from an image using a pre-trained VGG19 model and how to use these features to compute the content and style losses. Finally, we have shown how to put everything together to generate a stylized image.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Neural style transfer is a powerful technique that can be used to create beautiful and artistic images. By changing the style image, we can create different stylized versions of the same content image. With the knowledge gained in this tutorial, you can experiment with different style images and explore the creative possibilities of neural style transfer.\"\n    })]\n  });\n}\nfunction MDXContent(props = {}) {\n  const {wrapper: MDXLayout} = Object.assign({}, _provideComponents(), props.components);\n  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {\n    children: _jsx(_createMdxContent, props)\n  })) : _createMdxContent(props);\n}\nreturn {\n  default: MDXContent\n};\n","frontmatter":{},"scope":{}},"title":"Neural Style Transfer with PyTorch: A Comprehensive Tutorial","metaDesc":"Are you interested in creating your own digital artwork? Do you love the style of your favorite artists and want to replicate their techniques? Neural style transfer may be just the tool you need. In this tutorial, we will explore the basics of neural style transfer and demonstrate how to implement it using PyTorch, a popular deep learning framework.\n\n","tags":["PyTorch"],"slug":"neural-style-transfer-with-py-torch-a-comprehensive-tutorial","readTime":5,"img":"https://images.pexels.com/photos/4078342/pexels-photo-4078342.jpeg?auto=compress\u0026cs=tinysrgb\u0026w=1260\u0026h=750\u0026dpr=1","author":{"data":{"id":1,"attributes":{"username":"vishwesh","email":"vishwesh.singh1991@gmail.com","provider":"local","confirmed":false,"blocked":false,"createdAt":"2023-04-30T11:12:14.071Z","updatedAt":"2023-04-30T11:12:14.071Z"}}}},"__N_SSG":true},"page":"/python/[python]","query":{"python":"neural-style-transfer-with-py-torch-a-comprehensive-tutorial"},"buildId":"NVcWuSLW1x5mL-DBY0SbX","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>